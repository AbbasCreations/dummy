<!doctype html>
<html lang="en">
  <head>

    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css?family=Comfortaa:300,700|Lobster+Two" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Romanesco&display=swap" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Quicksand&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@900&amp;display=swap" rel="stylesheet">


    <!-- Bootstrap CSS -->    
    <title>Surprise for you</title>
<style>
 body {
cursor: url('F.png'), auto;	
  width: 100vw;
  height: 100vh;
  font-family: "Montserrat", sans-serif;
  background-image: radial-gradient(circle, #edc9db, #f391c3);
}

.app {
  width: 100vw;
  height: 100vh;
  display: grid;
  align-items: center;
  justify-content: center;
}

.heart {
  perspective: 1000px;
  width: 100px;
  height: 100px;
  border: none;
  background: none;
  cursor: pointer;
  outline: none;
}
.heart::after {
  content: "";
  position: absolute;
  border-radius: 100%;
  left: 10%;
  bottom: -20%;
  width: 80%;
  height: 20%;
  background-color: rgba(179, 77, 121, 0.4);
  filter: blur(5px);
  transform: scale(var(--scale));
}
.heart svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  overflow: visible;
}
.heart .inner-wrapper {
  width: 100%;
  height: 100%;
  transform: scale(var(--scale));
  transition: 0.1s ease-out;
}
.heart .splash {
  width: 100%;
  height: 100%;
}
.heart .splash path {
  stroke: #ebadc8;
  stroke-width: 0;
  fill: none;
  transform-origin: center;
  animation-timing-function: linear;
  animation-duration: 0.5s;
  animation-name: splash;
}
.heart .heart-stroke {
  fill: none;
  stroke: white;
  stroke-width: 20px;
  stroke-dasharray: 300 1206;
  stroke-linecap: round;
}
.heart .heart-layer {
  transition: fill 0.3s ease-out;
  fill: hsl(334deg, var(--lightness), 50%);
  stroke: hsl(334deg, var(--lightness), 35%);
  stroke-width: 10px;
}
.heart .heart-shine {
  filter: blur(3px);
}

@keyframes splash {
  0% {
    transform: scale(0.1);
    stroke-width: 0;
  }
  30% {
    transform: scale(1);
    stroke-width: 50;
  }
  100% {
    transform: scale(2);
    stroke-width: 1;
  }
}
</style>
<body>


</body>
<script>
  import React, {useEffect, useState, useRef, memo} from 'https://cdn.skypack.dev/react';
import ReactDOM from 'https://cdn.skypack.dev/react-dom';

const PATH_LENGTH = 1506;
const LAYERS = 20;
const LAYER_GAP = 2; // In pixels

const clamp = (min, max, n) => (
  Math.min(max, Math.max(min, n))
);

const useDocumentEvent = (event, handler) => {
  useEffect(() => {
    const events = event.split(' ');
    events.forEach(event => document.addEventListener(event, handler));
    return () => events.forEach(event => document.removeEventListener(event, handler));
  }, []);
};

const useTimeArray = delay => {
  const [timestamps, setTimestamps] = useState([]);
  const timeout = useRef();
  useEffect(() => {
    return () => clearTimeout(timeout.current);
  }, []);
  return {timestamps, add: () => {
    setTimestamps(arr => [...arr, Date.now()]);
    timeout.current = setTimeout(() => setTimestamps(arr => arr.filter(t => Date.now() - t < delay)), delay + 1);
  }};
};

const useCursorTilt = ({ref, tilt, bounds}) => {
  const [rotate, setRotate] = useState([-25,25]);
  useEffect(() => {
    const handleMouseMove = e => {
      requestAnimationFrame(() => {
        const {left, top, width, height} = ref.current.getBoundingClientRect();
        const [x, y] = [e.clientX, e.clientY];
        const rect = bounds 
          ? {top: top - bounds, left: left - bounds, width: width + bounds * 2, height: height + bounds * 2}
          : {top: 0, left: 0, width: window.innerWidth, height: window.innerHeight};
        
        setRotate([
          (-(clamp(0, rect.height, y - rect.top) - (rect.height/2)) / rect.height) * tilt,
          ((clamp(0, rect.width, x - rect.left) - (rect.width/2)) / rect.width) * tilt,
        ]);
      });
    }
    document.addEventListener('mousemove', handleMouseMove);
    return () => document.removeEventListener('mousemove', handleMouseMove);
  }, []);
  return rotate;
};

const Splash = memo(({circles}) => {
  return (
    <svg viewBox='0 0 500 430' className='splash'>
      {circles.map(timestamp => (
        <HeartPath key={timestamp}/>
        // <circle cx={50} cy={50} r={50} key={timestamp}/>
      ))}
    </svg>
  );
});

const HeartPath = () => (
  <path d="M500 143.64C500 286.45 321.49 322.15 250.08 429.26C178.68 322.15 0.17 286.45 0.17 143.64C0.17 72.24 53.72 0.83 142.98 0.83C214.38 0.83 250.08 72.24 250.08 72.24C250.08 72.24 285.79 0.83 357.19 0.83C446.45 0.83 500 72.24 500 143.64Z"/>
);

const ShineSVG = ({x, opacity, rotate, translateZ}) => (
  <svg viewBox="0 0 500 430" style={{transform: `rotateX(${rotate.x}deg) rotateY(${rotate.y}deg) translateZ(${translateZ}px) scale(0.9)`}} className='heart-shine'>
    <defs>
      <clipPath id="heart">
        <HeartPath/>
      </clipPath>
    </defs>
    <rect x={500 - x * (700)} y='0' width='200' height='430' fill={`rgba(255,255,255,${opacity}`} clipPath='url(#heart)'/>
  </svg>
);

const HeartSVG = ({rotate: {x, y}, translateZ, strokeDashoffset, scale = 1, className}) => (
  <svg className={className} viewBox="0 0 500 430" style={{transform: `rotateX(${x}deg) rotateY(${y}deg) translateZ(${translateZ}px) scale(${scale})`, strokeDashoffset}}>
    <HeartPath/>
  </svg>
);

const Heart = () => {
  const ref = useRef();
  const [love, setLove] = useState(1);
  const [pressed, setPressed] = useState(false);
  const {timestamps, add} = useTimeArray(1000);
  const [x,y] = useCursorTilt({ref, tilt: 50, bounds: 50});
  const offset = (Math.atan2(y, x) / Math.PI) * (PATH_LENGTH / 2) + PATH_LENGTH / 2;
  useDocumentEvent('mouseup', () => {
    setPressed(pressed => {
      if (pressed) {
        setLove(a => {
          if (a >= 1) {
            return 0;
          }
          add();
          return a + 0.3;
        });
      }
      return false;
    });
  });
  
  return (
    <button className='heart' onMouseDown={() => setPressed(true)} ref={ref} style={{'--lightness': `${love * 80 + 20}%`, '--scale': 0.8 + love * 0.2 - pressed * 0.1}}>
      <div className='inner-wrapper'>
        <Splash circles={timestamps}/>
        {[... new Array(LAYERS)].map((_, i) => (
          <HeartSVG className='heart-layer' rotate={{x, y}} translateZ={i * LAYER_GAP} scale={Math.sin((i / LAYERS)*Math.PI)/10 + 1}/>
        ))}
        <HeartSVG className='heart-stroke' rotate={{x, y}} translateZ={(LAYERS + 1) * LAYER_GAP} strokeDashoffset={offset} scale={0.9}/>
        <ShineSVG x={y / 50 + 0.5} opacity={x / 200 + 0.5} rotate={{x, y}} translateZ={(LAYERS + 1) * LAYER_GAP}/>
        ME
      </div>
    </button>
  );
};

const App = () => (
  <div className='app'>
    <Heart/>
  </div>
);

ReactDOM.render(
  <App/>,
  document.body
);
    </script>
</html>
